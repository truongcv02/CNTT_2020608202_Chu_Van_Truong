<!DOCTYPE HTML>
<html>
<head>
    <link href="/Assets/client/css/style.css" rel="stylesheet" type="text/css" media="all" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <!--slider-->
    <title>Trang chủ Hưng Hà Town</title>
    <script src="/Assets/client/js/jquery.min.js"></script>
    <script src="/Assets/client/js/script.js" type="text/javascript"></script>
    <script src="/Assets/client/js/superfish.js"></script>
    <link rel="icon"
          type="image/png"
          sizes="16x16"
          href="~/Assets/admin/assets/images/logoicon.png" />

</head>

<body>
    <div class="wrap">
        <div class="total">
            <div class="header">
                <div class="header-bot">
                    <div class="logo">
                        <a href="@Url.Action("Index","Home")"><img src="~/Assets/admin/assets/images/logo.png" alt="" /></a>
                    </div>
                    <div class="f-right">
                        @{
                            string a = "";
                            if (Session["Hoten"] != null)
                            {
                                a = Session["Hoten"].ToString();
                            }
                        }
                        <p class="welcome-msg">Chào mừng bạn tới với HungHatown, @a</p>
                        <div class="clear"></div>
                        <ul class="links">

                            @if (Session["ID_KhachHang"] != null && int.TryParse(Session["ID_KhachHang"].ToString(), out int khachHangId))
                            {
                                <li class="first"><a href="@Url.Action("Index","ThongTinCaNhan")" title="My Account">Tài khoản</a></li>
                                <li><a href="@Url.Action("Index","DonHangs", new { id = khachHangId,tt=0 })" title="My Order">Đơn hàng</a></li>
                                <li><a href="@Url.Action("Index","GioHangs", new { id = khachHangId })" title="My Cart" class="top-link-cart">Giỏ hàng</a></li>
                            }
                            @if (Session["Hoten"] == null)
                            {
                                <li class=""><a href="@Url.Action("Index", "DangKy", new { area = "Admin" })" title="Register">Đăng Ký</a></li>
                                <li class=""><a href="@Url.Action("Index", "Login", new { area = "Admin" })" title="Log In">Đăng nhập</a></li>
                            }
                            else
                            {
                                <li class=" last"><a href="@Url.Action("Logout2", "Home", new { area = "Admin" })" title="Logout">Đăng xuất</a></li>
                            }
                        </ul>
                    </div>

                    <div class="clear"></div>
                </div>
            </div>
            <div class="header_bottom">
                @{Html.RenderAction("MainMenu", "Home");}
                <select id="priceOrder" style="background-color: black; color: white; border: none; margin-left: 270px; margin-top: 10px"  >
                    <option value="">Sắp xếp theo giá</option>
                    <option value="asc">Giá tăng dần</option>
                    <option value="desc">Giá giảm dần</option>
                </select>
                <div class="search_box">
                    <form id="searchForm">
                        @if (TempData["tenSp"] != null)
                        {
                            <input type="text" id="searchInput" value="@TempData["tenSP"]" onfocus="this.value='';" onblur="if(this.value==''){this.value='Search';}">
                        }
                        else
                        {
                            <input type="text" id="searchInput" value="Search" onfocus="this.value='';" onblur="if(this.value==''){this.value='Search';}">
                        }
                        <input type="submit" value="">
                    </form>
                </div>
                <div class="clear"></div>
            </div>
            @RenderSection("banner", required: false)

            <div class="main">
                @RenderBody()
            </div>

            <div class="footer">
                <div class="footer-top">
                    <div class="col_1_of_4 span_1_of_4" style="width:30%">
                        <h3>Thông tin</h3>
                        <ul>
                            <li><a href="@Url.Action("About","Home")">Về chúng tôi</a></li>
                            <li><a href="https://maps.app.goo.gl/ReMLdRXHTBrMp7ES9">Bản đồ</a></li>
                            <li><a href="@Url.Action("Contact","Home")">Liên hệ</a></li>
                        </ul>
                    </div>
                    <div class="col_1_of_4 span_1_of_4" style="width:30%">
                        <h3>Danh mục</h3>
                        <ul>
                            <li><a href="@Url.Action("Index","Home")">Sản phẩm bán chạy</a></li>
                            <li><a href="@Url.Action("Index","Home")">Sản phẩm mới</a></li>
                            <li><a href="@Url.Action("Index","SanPhams")">Sản phẩm</a></li>
                        </ul>
                    </div>

                    <div class="col_1_of_4 span_1_of_4 footer-lastgrid" style="width:30%">
                        <h3>Theo dõi chúng tôi</h3>
                        <ul>
                            <li><a href="https://www.facebook.com/profile.php?id=100076619373182">FACEBOOK</a></li>
                            <li><a href="#">TWITTER</a></li>
                            <li><a href="#">RSS</a></li>
                        </ul>
                    </div>
                    <div class="clear"></div>
                </div>

            </div>
        </div>
    </div>
</body>
</html>
<script>
    document.getElementById('searchForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Ngăn chặn form gửi mặc định
        const query = document.getElementById('searchInput').value;
        const priceOrder = document.getElementById('priceOrder').value;
        let url = '@Url.Action("Index", "TimKiem")';

        if (query && query !== 'Search') {
            url += '?tenSanPham=' + encodeURIComponent(query);
        }

        if (priceOrder) {
            url += (query && query !== 'Search') ? '&' : '?';
            url += 'priceOrder=' + encodeURIComponent(priceOrder);
        }
        window.location.href = url;
    });

    document.getElementById('priceOrder').addEventListener('change', function () {
        const currentUrl = new URL(window.location.href);
        const params = new URLSearchParams(currentUrl.search);
        // Lấy giá trị tìm kiếm
        let searchQuery = document.getElementById('searchInput').value;
        if (!searchQuery || searchQuery === 'Search') {
            searchQuery = '';
        }
        params.set('tenSanPham', searchQuery);
        // Xóa biến sắp xếp cũ nếu có
        params.delete('priceOrder');

        // Lấy giá trị mới của biến sắp xếp
        const priceOrder = document.getElementById('priceOrder').value;

        // Nếu có giá trị mới cho priceOrder, thêm nó vào URL
        if (priceOrder) {
            params.set('priceOrder', priceOrder);
        }


        let url = '@Url.Action("Index", "TimKiem")';
        // Tạo URL mới với các tham số đã được cập nhật
        url += `?${params.toString()}`;
        window.location.href = url;
    });
</script>

